WORLD_SIZE=32
MASTER_ADDR=udc-aj33-9
Peak allocated bytes on cuda:1: 20.265743GB
Peak allocated bytes on cuda:2: 20.265743GB
Peak allocated bytes on cuda:3: 20.265743GB
Running DP benchmark with args: Namespace(batch_size=1, benchmark_eval=False, clip_value=0.05, debug=False, dropout=0, dry_run=False, enable_auto_wrap=False, epochs=1, full_fp16=False, initrange=0.1, lr=0.001, max_batch=4, model_name='lm', nhead=32, nhid=5120, ninp=1280, num_decoder_layers=36, seq_len=1025, use_synthetic_data=True, vocab_size=50256)
--------------------------------------------------------------------------------------------------------------
| start of epoch 1
--------------------------------------------------------------------------------------------------------------
| batch     1 | wps 99.90 | loss 25.88 | ppl 174331070204.37
| batch     2 | wps 79.02 | loss 12.52 | ppl 273736.26
| batch     3 | wps 80.97 | loss 12.15 | ppl 189226.97
| batch     4 | wps 79.18 | loss 11.95 | ppl 155568.97
--------------------------------------------------------------------------------------------------------------
| end of epoch 1 | time: 59.42s 
--------------------------------------------------------------------------------------------------------------
Throughput(wps) is 79.96.
Elapsed_time(s) is 59.42.
Peak allocated bytes on cuda:0: 20.265743GB
Peak allocated bytes on cuda:2: 11.033762GB
Peak allocated bytes on cuda:1: 11.033762GB
Peak allocated bytes on cuda:3: 11.033762GB
Running FSDP benchmark with args: Namespace(batch_size=1, benchmark_eval=False, clip_value=0.05, debug=False, dropout=0, dry_run=False, enable_auto_wrap=False, epochs=1, full_fp16=False, initrange=0.1, lr=0.001, max_batch=4, model_name='lm', nhead=32, nhid=5120, ninp=1280, num_decoder_layers=36, seq_len=1025, use_synthetic_data=True, vocab_size=50256)
--------------------------------------------------------------------------------------------------------------
| start of epoch 1
--------------------------------------------------------------------------------------------------------------
| batch     1 | wps 157.22 | loss 25.88 | ppl 174331070204.37
| batch     2 | wps 233.45 | loss 12.52 | ppl 273737.04
| batch     3 | wps 245.15 | loss 12.15 | ppl 189227.33
| batch     4 | wps 235.51 | loss 11.95 | ppl 155568.83
--------------------------------------------------------------------------------------------------------------
| end of epoch 1 | time: 25.99s 
--------------------------------------------------------------------------------------------------------------
Throughput(wps) is 245.04.
Elapsed_time(s) is 25.99.
Peak allocated bytes on cuda:0: 11.033762GB
Peak allocated bytes on cuda:1: 3.502173GB
Peak allocated bytes on cuda:3: 3.502173GB
Peak allocated bytes on cuda:2: 3.502173GB
Running RTP-out-of-place benchmark with args: Namespace(batch_size=1, benchmark_eval=False, clip_value=0.05, debug=False, dropout=0, dry_run=False, enable_auto_wrap=False, epochs=1, full_fp16=False, initrange=0.1, lr=0.001, max_batch=4, model_name='lm', nhead=32, nhid=5120, ninp=1280, num_decoder_layers=36, seq_len=1025, use_synthetic_data=True, vocab_size=50256)
--------------------------------------------------------------------------------------------------------------
| start of epoch 1
--------------------------------------------------------------------------------------------------------------
| batch     1 | wps 60.78 | loss 25.88 | ppl 174239487728.23
| batch     2 | wps 110.67 | loss 12.53 | ppl 275912.40
| batch     3 | wps 113.21 | loss 12.16 | ppl 190951.32
| batch     4 | wps 111.60 | loss 11.97 | ppl 157420.19
--------------------------------------------------------------------------------------------------------------
| end of epoch 1 | time: 61.58s 
--------------------------------------------------------------------------------------------------------------
Throughput(wps) is 111.71.
Elapsed_time(s) is 61.58.
Peak allocated bytes on cuda:0: 3.502173GB
Peak allocated bytes on cuda:1: 3.502173GB
Peak allocated bytes on cuda:2: 3.502173GB
Running RTP-in-place benchmark with args: Namespace(batch_size=1, benchmark_eval=False, clip_value=0.05, debug=False, dropout=0, dry_run=False, enable_auto_wrap=False, epochs=1, full_fp16=False, initrange=0.1, lr=0.001, max_batch=4, model_name='lm', nhead=32, nhid=5120, ninp=1280, num_decoder_layers=36, seq_len=1025, use_synthetic_data=True, vocab_size=50256)
--------------------------------------------------------------------------------------------------------------
| start of epoch 1
--------------------------------------------------------------------------------------------------------------
| batch     1 | wps 53.41 | loss 25.88 | ppl 174239487728.23
| batch     2 | wps 93.84 | loss 12.53 | ppl 276654.64
| batch     3 | wps 95.71 | loss 12.16 | ppl 191166.15
| batch     4 | wps 95.57 | loss 11.97 | ppl 157543.19
--------------------------------------------------------------------------------------------------------------
| end of epoch 1 | time: 71.06s 
--------------------------------------------------------------------------------------------------------------
Throughput(wps) is 95.16.
Elapsed_time(s) is 71.06.
Peak allocated bytes on cuda:0: 3.502173GB
Peak allocated bytes on cuda:3: 3.502173GB
