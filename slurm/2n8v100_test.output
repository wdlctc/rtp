WORLD_SIZE=8
MASTER_ADDR=udc-aj38-35
Peak allocated bytes on cuda:2: 20.265743GB
Peak allocated bytes on cuda:3: 20.265743GB
Peak allocated bytes on cuda:1: 20.265743GB
Running DP benchmark with args: Namespace(batch_size=1, benchmark_eval=False, clip_value=0.05, debug=False, dropout=0, dry_run=False, enable_auto_wrap=False, epochs=1, full_fp16=False, initrange=0.1, lr=0.001, max_batch=4, model_name='lm', nhead=32, nhid=5120, ninp=1280, num_decoder_layers=36, seq_len=1025, use_synthetic_data=True, vocab_size=50256)
--------------------------------------------------------------------------------------------------------------
| start of epoch 1
--------------------------------------------------------------------------------------------------------------
| batch     1 | wps 416.55 | loss 25.88 | ppl 174331070204.37
| batch     2 | wps 635.95 | loss 12.52 | ppl 273737.04
| batch     3 | wps 502.96 | loss 12.15 | ppl 189226.97
| batch     4 | wps 817.72 | loss 11.95 | ppl 155568.83
--------------------------------------------------------------------------------------------------------------
| end of epoch 1 | time: 10.19s 
--------------------------------------------------------------------------------------------------------------
Throughput(wps) is 605.48.
Elapsed_time(s) is 10.19.
Peak allocated bytes on cuda:0: 20.265743GB
Peak allocated bytes on cuda:2: 9.223400GB
Peak allocated bytes on cuda:3: 9.258696GB
Peak allocated bytes on cuda:1: 9.223400GB
Running RTP-out-of-place benchmark with args: Namespace(batch_size=1, benchmark_eval=False, clip_value=0.05, debug=False, dropout=0, dry_run=False, enable_auto_wrap=False, epochs=1, full_fp16=False, initrange=0.1, lr=0.001, max_batch=4, model_name='lm', nhead=32, nhid=5120, ninp=1280, num_decoder_layers=36, seq_len=1025, use_synthetic_data=True, vocab_size=50256)
--------------------------------------------------------------------------------------------------------------
| start of epoch 1
--------------------------------------------------------------------------------------------------------------
| batch     1 | wps 176.74 | loss 25.88 | ppl 174212072210.77
| batch     2 | wps 356.43 | loss 12.52 | ppl 274104.33
| batch     3 | wps 350.51 | loss 12.15 | ppl 189695.30
| batch     4 | wps 363.42 | loss 11.96 | ppl 155996.84
--------------------------------------------------------------------------------------------------------------
| end of epoch 1 | time: 20.54s 
--------------------------------------------------------------------------------------------------------------
Throughput(wps) is 356.97.
Elapsed_time(s) is 20.54.
Peak allocated bytes on cuda:0: 9.252839GB
Peak allocated bytes on cuda:3: 9.264630GB
Peak allocated bytes on cuda:2: 9.231797GB
Peak allocated bytes on cuda:1: 9.231797GB
Running RTP-in-place benchmark with args: Namespace(batch_size=1, benchmark_eval=False, clip_value=0.05, debug=False, dropout=0, dry_run=False, enable_auto_wrap=False, epochs=1, full_fp16=False, initrange=0.1, lr=0.001, max_batch=4, model_name='lm', nhead=32, nhid=5120, ninp=1280, num_decoder_layers=36, seq_len=1025, use_synthetic_data=True, vocab_size=50256)
--------------------------------------------------------------------------------------------------------------
| start of epoch 1
--------------------------------------------------------------------------------------------------------------
| batch     1 | wps 154.31 | loss 25.88 | ppl 174212072210.77
| batch     2 | wps 285.62 | loss 12.52 | ppl 274122.63
| batch     3 | wps 297.91 | loss 12.15 | ppl 189653.88
| batch     4 | wps 282.73 | loss 11.96 | ppl 155946.12
--------------------------------------------------------------------------------------------------------------
| end of epoch 1 | time: 24.27s 
--------------------------------------------------------------------------------------------------------------
Throughput(wps) is 290.37.
Elapsed_time(s) is 24.27.
Peak allocated bytes on cuda:0: 9.271973GB
